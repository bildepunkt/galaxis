{"version":3,"sources":["webpack:///webpack/bootstrap 556244026fde2f3c6132","webpack:///./play/main.js","webpack:///./src/Game.js","webpack:///./src/Camera.js","webpack:///./src/Pool.js","webpack:///./src/util.js","webpack:///./src/Viewport.js","webpack:///./src/Input.js","webpack:///./src/Listeners.js","webpack:///./src/FSM.js","webpack:///./src/Ticker.js","webpack:///./src/Preloader.js","webpack:///./src/debug.js","webpack:///./src/Sprite.js"],"names":["initial","init","console","log","bgColor","rect","pivotX","pivotY","scaleX","scaleY","alpha","draggable","rect2","pool","add","listeners","e","target","update","delta","x","width","fsm","load","remove","removeAll","play","game","reset","preload","debug","Game","states","options","defaults","height","id","listenForMouse","listenForTouch","listenForKeyboard","Object","assign","hasBooted","boot","bind","camera","viewport","input","canvas","ticker","cancel","length","state","context","executeHandlers","clear","save","translate","y","each","item","render","restore","Camera","Pool","items","push","index","getCount","splice","fn","scope","i","len","doContinue","filteredItems","predicate","fromIndex","indexOf","getIndex","movee","indices","addAt","isAtFront","isAtBack","removee","removed","itemMatch","a","b","uid","getBoundingBox","w","Math","abs","h","x1","globalX","y1","globalY","x2","y2","minX","minY","maxX","maxY","pointRectCollide","bb","getScaleFactor","factor","style","cssWidth","parseInt","Viewport","document","querySelector","getContext","fill","fillStyle","fillRect","clearRect","ClickManager","start","end","startEvent","endEvent","clickee","event","clickEvents","type","DragManager","move","moveEvent","dragee","isDragging","canDrag","dragEvents","Input","queuedEvents","handleEvents","addEventListener","mouseClickManager","mouseDragManager","touchClickManager","touchDragManager","preventDefault","stopPropagation","boundingRect","getBoundingClientRect","scaleFactor","domEvent","ctrlKey","shiftKey","metaKey","button","touches","pageX","pageY","changedTouches","round","left","window","scrollX","top","scrollY","deltaX","deltaY","concat","getEvents","Listeners","dragActionManager","offset","handle","handler","events","original","handlerObj","FSM","name","Ticker","callback","then","Date","now","cancelled","requestId","requestAnimationFrame","min","cancelAnimationFrame","Preloader","paths","loaded","count","path","asset","getType","Audio","Image","onload","onLoad","drawGrid","size","color","halfWidth","halfHeight","linesX","linesY","strokeStyle","globalAlpha","lineWidth","beginPath","moveTo","lineTo","stroke","drawPivot","halfSize","Sprite","rotation","visible","composite","rotate","PI","scale","globalCompositeOperation","compositeOperation"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 556244026fde2f3c6132","import Game from \"../src/Game\";\nimport Sprite from \"../src/Sprite\";\nimport { getBoundingBox } from \"../src/util\";\n\nnew Game({\n    initial: {\n        init () {\n            console.log(\"initial#init\");\n\n            this.bgColor = \"#678\";\n\n            this.rect = new Sprite(64, 64); \n            this.rect.pivotX = 32;\n            this.rect.pivotY = 32;\n            this.rect.scaleX = -2;\n            this.rect.scaleY = -2;\n            this.rect.alpha = 0.2;\n            //this.rect.rotation = 7.5;\n            this.rect.draggable = true;\n            console.log(getBoundingBox(this.rect));\n\n            this.rect2 = new Sprite(256, 256);\n            this.rect2.draggable = true;    \n            this.rect2.scaleX = -1;\n            this.rect2.scaleY = -1;\n            this.rect2.alpha = 0.4;\n            console.log(getBoundingBox(this.rect2));\n\n            this.pool.add(this.rect, this.rect2);\n\n            this.listeners.add(\"click\", (e)=> {\n                console.log(e.target);\n                console.log(getBoundingBox(e.target));\n            }, this.rect);\n\n            this.listeners.add(\"drag\", (e)=> {\n                console.log(e.target);\n                console.log(getBoundingBox(e.target));\n            }, this.rect2);\n\n            console.log(this.listeners, 2);\n        },\n        update (delta) {\n            //console.log(\"initial#update\", delta);\n\n            //let speed = delta / 4;\n\n            //this.rect.x += speed;\n            //this.rect.rotation += speed;\n\n            if (this.rect.x + this.rect.width >= this.width) {\n                this.fsm.load(\"play\");\n            }\n        },\n        remove () {\n            console.log(\"initial#remove\");\n\n            this.pool.removeAll();\n        }\n    },\n    play: {\n        init () {\n            console.log(\"play#init\");\n            console.log(this.listeners);\n        },\n        update (delta) {\n            console.log(\"play#update\", delta);\n\n            this.game.reset();\n        }\n    }\n}, {\n    preload: [\n        \"assets/cragger.png\"\n    ],\n    debug: true\n});\n\n\n\n// WEBPACK FOOTER //\n// ./play/main.js","import Camera from \"./Camera\";\nimport Pool from \"./Pool\";\nimport Viewport from \"./Viewport\";\nimport Input from \"./Input\";\nimport Listeners from \"./Listeners\";\nimport FSM from \"./FSM\";\nimport Ticker from \"./Ticker\";\nimport Preloader from \"./Preloader\";\nimport { drawGrid, drawPivot } from \"./debug\";\n\nexport default class Game {\n    constructor (states, options={}) {\n        const defaults = {\n            width: 640,\n            height: 512,\n            id: \"game\",\n            preload: [],\n            debug: false,\n            listenForMouse: true,\n            listenForTouch: true,\n            listenForKeyboard: true\n        };\n\n        this.states = states;\n        this.options = Object.assign(defaults, options);\n        this.hasBooted = false;\n\n        this.boot();\n    }\n\n    boot () {\n        // psuedo game object\n        this.game = {\n            reset: this.boot.bind(this)\n        };\n        this.camera = new Camera();\n        this.pool = new Pool();\n        this.viewport = new Viewport(this.options);\n        this.input = new Input(this.viewport.canvas, this.pool, this.options);\n        this.listeners = new Listeners(this.input);\n        this.fsm = new FSM(this);\n\n        if (this.hasBooted) {\n            this.ticker.cancel();\n        }\n\n        this.ticker = new Ticker(this.update.bind(this));\n\n        if (!this.hasBooted && this.options.preload.length) {\n            new Preloader(this.options.preload, ()=> {\n                this.fsm.load(\"initial\");\n            });\n        } else {\n            this.fsm.load(\"initial\");\n        }\n\n        this.hasBooted = true;\n    }\n\n    update (delta) {\n        if (!this.fsm.state) {\n            return;\n        }\n\n        let context = this.viewport.context;\n\n        this.listeners.executeHandlers();\n\n        this.viewport.clear(this.fsm.state.bgColor);\n        context.save();\n        context.translate(-this.camera.x, -this.camera.y);\n\n        if (this.options.debug) {\n            drawGrid(context, this.options.width, this.options.height);\n        }\n\n        this.fsm.state.update(delta);\n        this.fsm.state.pool.each(item=> {\n            context.save();\n            item.render(context);\n\n            if (this.options.debug) {\n                context.translate(item.pivotX, item.pivotY);\n                drawPivot(context);\n            }\n\n            context.restore();\n        }, this);\n\n        context.restore();\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Game.js","export default class Camera {\n    constructor (x=0, y=0) {\n        this.x = x;\n        this.y = y;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Camera.js","import { itemMatch } from \"./util\";\n\nexport default class Pool {\n    constructor (...items) {\n        this.items = items || [];\n    }\n    \n    /**\n     * Add n items(s)\n     * @method Collection#add\n     * @param  {...Object} items - item(s) to add\n     */\n    add (...items) {\n        for (let item of items) {\n            this.items.push(item);\n        }\n    }\n\n    /**\n     * Add an item at a given index\n     * @method Collection#addAt\n     * @param  {Integer} index - The index to add the item\n     * @param  {Any}     item - The item to add\n     */\n    addAt (index, item) {\n        if (index > this.getCount()) {\n            this.add(item);\n        } else {\n            this.items.splice(index, 0, item);\n        }\n    }\n\n    /**\n     * Iterates the collection's sorted items. The item, index, and name are supplied\n     * to the provided function\n     * @method Collection#each\n     * @param {Function} fn - The function to execute on the iterable\n     * @param {Object} [scope] - The scope with which to execute the function\n     */\n    each (fn, scope) {\n        fn = scope ? fn.bind(scope) : fn;\n\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            let doContinue;\n\n            // if item on last item and an item is removed\n            if (!item) {\n                break;\n            }\n\n            doContinue = fn(item, i);\n\n            if (doContinue === false) {\n                break;\n            }\n        }\n    }\n\n    /**\n     * Returns an object at a given index\n     * @method Collection#fetchAt\n     * @param  {Integer} index - The index\n     * @return {Any}\n     */\n    fetchAt (index) {\n        return this.items[index];\n    }\n\n    /**\n     * iterates items and return the ones that meet criteria\n     * @method Collection#filter\n     * @param  {Function} fn - Truth predicate\n     * @param  {Object} [scope] - The scope in which to execute the function\n     * @return {Array}\n     */\n    filter(fn, scope) {\n        let filteredItems = [];\n\n        this.each((item, i)=> {\n            let predicate = fn(item, i);\n\n            if (predicate) {\n                filteredItems.push(item);\n            }\n        }, scope);\n\n        return filteredItems;\n    }\n\n    /**\n     * Returns the count of items in group\n     * @method Collection#getCount\n     * @return {Integer} - The item count\n     */\n    getCount () {\n        return this.items.length;\n    }\n\n    /**\n     * Returns the given item's index, with optional starting index\n     * @method Collection#getIndex\n     * @param  {Any} item - the item to query\n     * @param  {Integer} [fromIndex] - starting index\n     * @return {Integer} - the item's index\n     */\n    getIndex (item, fromIndex) {\n        return this.items.indexOf(item, fromIndex);\n    }\n\n    /**\n     * Checks if item is at front of render order\n     * @method Collection#isAtFront\n     * @param  {Any} item - The item to query\n     * @return {Boolean} - If item is at front\n     */\n    isAtFront (item) {\n        return this.getIndex(item) === this.getCount() - 1;\n    }\n\n    /**\n     * Checks if item is at back of render order\n     * @method Collection#isAtBack\n     * @param  {Any} item - The item to query\n     * @return {Boolean} - If item is at back\n     */\n    isAtBack (item) {\n        return this.getIndex(item) === 0;\n    }\n\n    /**\n     * Moves an item to a new index\n     * @method Collection#move\n     * @param  {Any} movee - the item to move\n     * @param  {Integer} indices - the amount of indices to shift item. Can be positive/negative\n     * @return {Boolean} - Whether the item was successfully moved\n     */\n    move (movee, indices) {\n        const index = this.getIndex(movee);\n\n        if (indices === 0) {\n            return false;\n        }\n\n        // cannot move before begining (don't use isAtBack to save getIndex use)\n        if (index === 0 && indices < 0) {\n            return false;\n        }\n\n        // cannot move past end (don't use isAtFront to save getIndex use)\n        if (index === this.getCount() - 1 && indices > 0) {\n            return false;\n        }\n\n        this.remove(movee);\n        this.addAt(index + indices, movee);\n\n        return true;\n    }\n\n    /**\n     * Moves an item to the front of the render order\n     * @method Collection#moveToFront\n     * @param  {Any} movee - the item to move\n     * @return {Boolean} - Whether item successfully moved\n     */\n    moveToFront (movee) {\n        if (this.isAtFront(movee)) {\n            return false;\n        }\n\n        this.remove(movee);\n        this.addAt(this.getCount(), movee);\n\n        return true;\n    }\n\n    /**\n     * Moves an item to the back of the render order\n     * @method Collection#moveToBack\n     * @param  {Any} movee - the item to move\n     * @return {Boolean} - Whether item successfully moved\n     */\n    moveToBack (movee) {\n        if (this.isAtBack(movee)) {\n            return false;\n        }\n\n        this.remove(movee);\n        this.addAt(0, movee);\n\n        return true;\n    }\n\n    /**\n     * Remove item by name\n     * @method Collection#removeBy\n     * @param {String} removee - The item to remove\n     * @return {Boolean} - Whether item was successfully removed\n     */\n    remove (removee) {\n        let removed = false;\n\n        for (let i = 0, len = this.getCount(); i < len; i++) {\n            let item = this.items[i];\n            if (itemMatch(item, removee)) {\n                this.items.splice(i, 1);\n                removed = true;\n                break;\n            }\n        }\n\n        return removed;\n    }\n\n    /**\n     * Removes all items\n     * @method Collection#removeAll\n     */\n    removeAll () {\n        this.items = [];\n    }\n\n    /**\n     * Remove item at given index\n     * @method Collection#removeAt\n     * @param {Integer} index - The index of the item to remove\n     */\n    removeAt (index) {\n        this.items.splice(index, 1);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Pool.js","export const itemMatch = (a, b)=> {\n    return a.uid === b.uid;\n}\n\nexport const getBoundingBox = (item)=> {\n    let w = item.width * Math.abs(item.scaleX);\n    let h = item.height * Math.abs(item.scaleY);\n    let x1 = item.globalX;\n    let y1 = item.globalY;\n    let x2 = item.scaleX >= 0 ? x1 + w : x1 - w;\n    let y2 = item.scaleY >= 0 ? y1 + h : y1 - h;\n\n    return {\n        minX: x1 <= x2 ? x1 : x2,\n        minY: y1 <= y2 ? y1 : y2,\n        maxX: x1 >= x2 ? x1 : x2,\n        maxY: y1 >= y2 ? y1 : y2\n    };\n}\n\nexport const pointRectCollide = (x, y, rect)=> {\n    let bb = getBoundingBox(rect);\n    return x >= bb.minX && x <= bb.maxX && y >= bb.minY && y <= bb.maxY;\n}\n\nexport const getScaleFactor = (canvas)=> {\n    let factor = 1;\n\n    // check if canvas has been scaled via CSS\n    if (canvas.style.width) {\n        let cssWidth = parseInt(canvas.style.width, 10);\n        factor = canvas.width / cssWidth;\n    }\n\n    return factor;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util.js","export default class Viewport {\n    constructor (options) {\n        this.width = options.width;\n        this.height = options.height;\n        this.canvas = document.querySelector(\"#\" + options.id);\n        this.canvas.width = this.width;\n        this.canvas.height = this.height;\n        this.context = this.canvas.getContext(\"2d\");\n    }\n\n    clear (fill) {\n        if (fill) {\n            this.context.fillStyle = fill;\n            this.context.fillRect(0, 0, this.width, this.height);\n        } else {\n            this.context.clearRect(0, 0, this.width, this.height);\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Viewport.js","import { itemMatch, getScaleFactor, pointRectCollide } from \"./util\";\n\nclass ClickManager {\n    constructor (start, end) {\n        this.startEvent = start;\n        this.endEvent = end;\n        this.clickee = null;\n    }\n\n    getEvents (event) {\n        let clickEvents = [];\n\n        // emulate events\n        switch (event.type) {\n        case this.startEvent:\n            this.clickee = event.target;\n            break;\n        case this.endEvent:\n            if (this.clickee && itemMatch(this.clickee, event.target)) {\n                let type;\n\n                switch (this.endEvent) {\n                case \"mouseup\":\n                    type = \"click\";\n                    break;\n                case \"touchend\":\n                    type = \"tap\";\n                    break;\n                }\n\n                clickEvents.push(Object.assign({}, event, {\n                    type\n                }));\n            }\n\n            this.clickee = null;\n            break;\n        }\n\n        return clickEvents;\n    }\n}\n\nclass DragManager {\n    constructor (start, move, end) {\n        this.startEvent = start;\n        this.moveEvent = move;\n        this.endEvent = end;\n        this.dragee = null;\n        this.isDragging = false;\n        this.canDrag = false;\n    }\n\n    getEvents (event) {\n        let dragEvents = [];\n\n        // emulate events\n        switch (event.type) {\n        case this.startEvent:\n            this.canDrag = true;\n            this.dragee = event.target;\n            break;\n        case this.moveEvent:\n            if (this.canDrag) {\n                if (!this.isDragging) {\n                    dragEvents.push(Object.assign({}, event, {\n                        type: \"dragstart\",\n                        target: this.dragee\n                    }));\n                }\n\n                dragEvents.push(Object.assign({}, event, {\n                    type: \"drag\",\n                    target: this.dragee\n                }));\n\n                this.isDragging = true;\n            }\n            break;\n        case this.endEvent:\n            if (this.isDragging) {\n                dragEvents.push(Object.assign({}, event, {\n                    type: \"dragend\",\n                    target: this.dragee\n                }));\n\n                this.isDragging = false;\n                this.dragee = null;\n            }\n\n            this.canDrag = false;\n            break;\n        }\n\n        return dragEvents;\n    }\n}\n\nexport default class Input {\n    constructor (canvas, pool, options) {\n        this.canvas = canvas;\n        this.pool = pool;\n        this.queuedEvents = [];\n        this.handleEvents = this.handleEvents.bind(this);\n\n        if (options.listenForMouse) {\n            this.canvas.addEventListener(\"mousedown\", this.handleEvents, false);\n            this.canvas.addEventListener(\"mouseup\", this.handleEvents, false);\n            this.canvas.addEventListener(\"mousemove\", this.handleEvents, false);\n            this.canvas.addEventListener(\"wheel\", this.handleEvents, false);\n\n            this.mouseClickManager = new ClickManager(\"mousedown\", \"mouseup\");\n            this.mouseDragManager = new DragManager(\"mousedown\", \"mousemove\", \"mouseup\");\n        }\n\n        if (options.listenForTouch) {\n            this.canvas.addEventListener(\"touchstart\", this.handleEvents, false);\n            this.canvas.addEventListener(\"touchend\", this.handleEvents, false);\n            this.canvas.addEventListener(\"touchmove\", this.handleEvents, false);\n\n            this.touchClickManager = new ClickManager(\"touchstart\", \"touchend\");\n            this.touchDragManager = new DragManager(\"touchstart\", \"touchmove\", \"touchend\");\n        }\n\n        if (options.listenForKeyboard) {\n            this.canvas.addEventListener(\"keydown\", this.handleEvents, false);\n            this.canvas.addEventListener(\"keyup\", this.handleEvents, false);\n        }\n    }\n\n    handleEvents (e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        let boundingRect = this.canvas.getBoundingClientRect();\n        let scaleFactor = getScaleFactor(this.canvas);\n        let event = {\n            domEvent: e,\n            type: e.type,\n            ctrlKey: e.ctrlKey,\n            shiftKey: e.shiftKey,\n            metaKey: e.metaKey,\n            button: e.button,\n            target: { uid: -1 }\n        };\n\n        if (e.type !== \"keyup\" && e.type !== \"keydown\") {\n            if (e.touches && e.touches.length) {\n                event.x = e.touches[0].pageX;\n                event.y = e.touches[0].pageY;\n            } else if (e.changedTouches && e.changedTouches.length) {\n                event.x = e.changedTouches[0].pageX;\n                event.y = e.changedTouches[0].pageY;\n            } else {\n                event.x = e.pageX;\n                event.y = e.pageY;\n            }\n\n            // coordinate positions relative to canvas scaling\n            event.x = Math.round((event.x - (boundingRect.left + window.scrollX)) * scaleFactor);\n            event.y = Math.round((event.y - (boundingRect.top + window.scrollY)) * scaleFactor);\n\n            // find and set target object\n            this.pool.each((item)=> {\n                if (pointRectCollide(event.x, event.y, item)) {\n                    event.target = item;\n                    // don't break, we want the last-most (highest) item\n                }\n            });\n        }\n\n        if (e.type === \"wheel\") {\n            event.deltaX = e.deltaX;\n            event.deltaY = e.deltaY;\n        }\n\n        this.queuedEvents.push(event);\n\n        this.queuedEvents = this.queuedEvents.concat(\n            this.mouseClickManager ? this.mouseClickManager.getEvents(event) : [],\n            this.touchClickManager ? this.touchClickManager.getEvents(event) : [],\n            this.mouseDragManager ? this.mouseDragManager.getEvents(event) : [],\n            this.touchDragManager ? this.touchDragManager.getEvents(event) : []\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Input.js","import { itemMatch } from \"./util\";\n\nexport default class Listeners {\n    constructor (input) {\n        this.input = input;\n        this.dragActionManager = {\n            dragee: null,\n            offset: {\n                x: 0,\n                y: 0\n            },\n\n            handle (event) {\n                switch (event.type) {\n                case \"dragstart\":\n                    if (event.target && event.target.draggable) {\n                        this.dragee = event.target;\n                        this.offset.x = event.x - this.dragee.x;\n                        this.offset.y = event.y - this.dragee.y;\n                    }\n                    break;\n                case \"drag\":\n                    if (this.dragee) {\n                        this.dragee.x = event.x - this.offset.x;\n                        this.dragee.y = event.y - this.offset.y;\n                    }\n                    break;\n                case \"dragend\":\n                    this.dragee = null;\n                    break;\n                }\n            }\n        };\n\n        this.reset();\n    }\n\n    add (type, handler, target) {\n        this.events[type].push({\n            original: handler,\n            handler: handler.bind(this.state),\n            target\n        });\n    }\n\n    remove (type, handler) {\n        for (let i = 0, len = this.events[type].length; i < len; i++) {\n            let event = this.events[type][i];\n\n            if (event.original === handler) {\n                this.events[type].splice(i, 1);\n                break;\n            }\n        }\n    }\n\n    executeHandlers () {\n        for (let event of this.input.queuedEvents) {\n            switch (event.type) {\n            case \"drag\":\n            case \"dragstart\":\n            case \"dragend\":\n                this.dragActionManager.handle(event);\n                break;\n            }\n\n            for (let handlerObj of this.events[event.type]) {\n                // if not drag|dragend event, and target given, and it matches OR no target given\n                // it doesn't apply to drag b/c on fast dragging, the event coordinates will move off the target\n                // it doesn't apply to dragend b/c a dragend can happen on higher (top-most) target\n                if (handlerObj.target ) {\n                    if (event.target && itemMatch(handlerObj.target, event.target)) {\n                        handlerObj.handler(event);\n                    }\n                } else {\n                    handlerObj.handler(event);\n                }\n            }\n        }\n\n        this.input.queuedEvents = [];\n    }\n\n    reset () {\n        // add all - even without listeners - b/c some are implicit eg: drag*\n        this.events = {\n            \"mousedown\": [],\n            \"mouseup\": [],\n            \"mousemove\": [],\n            \"click\": [],\n            \"wheel\": [],\n            \"touchstart\": [],\n            \"touchend\": [],\n            \"touchmove\": [],\n            \"tap\": [],\n            \"drag\": [],\n            \"dragstart\": [],\n            \"dragend\": []\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Listeners.js","export default class FSM {\n    constructor (game) {\n        this.states = game.states;\n        this.game = game.game;\n        this.listeners = game.listeners;\n        this.camera = game.camera;\n        this.pool = game.pool;\n        this.width = game.options.width;\n        this.height = game.options.height;\n    }\n    \n    load (name) {\n        if (this.state && this.state.remove) {\n            this.state.remove();\n        }\n\n        this.listeners.reset();\n\n        this.state = this.states[name];\n\n        this.state.game = this.game;\n        this.state.listeners = this.listeners;\n        this.state.camera = this.camera\n        this.state.pool = this.pool;\n        this.state.fsm = this;\n        this.state.width = this.width;\n        this.state.height = this.height;\n\n        if (this.state.init) {\n            this.state.init();\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/FSM.js","export default class Ticker {\n    constructor (callback) {\n        this.callback = callback;\n        this.then = Date.now();\n        this.update = this.update.bind(this);\n        this.cancelled = false\n\n        this.requestId = requestAnimationFrame(this.update);\n    }\n\n    update () {\n        if (this.cancelled) {\n            return;\n        }\n\n        let now = Date.now();\n        // use min to cap delta so things don't go haywire on \"blur\"\n        let delta = Math.min(now - this.then, 32);\n\n        this.callback(delta);\n        this.then = now;    \n\n        this.requestId = requestAnimationFrame(this.update);\n    }\n\n    cancel () {\n        this.cancelled = true;\n        cancelAnimationFrame(this.requestId);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Ticker.js","export default class Preloader {\n    constructor (paths, callback) {\n        this.callback = callback;\n        this.loaded = 0;\n        this.count = paths.length;\n\n        for (let path of paths) {\n            let asset;\n\n            switch (this.getType(path)) {\n            case \"audio\":\n                asset = new Audio();\n                break;\n            case \"image\":\n                asset = new Image();\n                break;\n            }\n\n            asset.onload = this.onLoad();\n        }\n    }\n\n    getType (path) {\n        return path.indexOf(\".mp3\") > 0 || path.indexOf(\".wav\") > 0 || path.indexOf(\".ogv\") > 0 ?\n            \"audio\" :\n            \"image\";\n    }\n\n    onLoad () {\n        this.loaded++;\n        console.log(`asset ${this.loaded} of ${this.count} loaded`);\n\n        if (this.loaded === this.count) {\n            console.log(\"assets loaded\");\n            this.callback();\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Preloader.js","export const drawGrid = (context, width, height, size=32, color=\"#000\")=> {\n    const halfWidth = width / 2;\n    const halfHeight = height / 2;\n    const linesX = width / size;\n    const linesY = height / size;\n    const count = linesX > linesY ? linesX : linesY;\n    let i = -1;\n\n    context.save();\n    context.strokeStyle = color;\n    context.translate(width / 2, height / 2);\n    context.globalAlpha = 0.6;\n    context.lineWidth = 1;\n\n    while (i++ < count) {\n        if (i !== 0) {\n            context.globalAlpha = i % 2 > 0 ? 0.2 : 0.4;\n        }\n\n        context.beginPath();\n        \n        context.moveTo(-halfWidth, -i * size);\n        context.lineTo(width, -i * size);\n        context.moveTo(-halfWidth, i * size);\n        context.lineTo(width, i * size);\n        \n        context.moveTo(-i * size, -halfHeight);\n        context.lineTo(-i * size, height);\n        context.moveTo(i * size, -halfHeight);\n        context.lineTo(i * size, height);\n        \n        context.stroke();\n    }\n\n    context.restore();\n}\n\nexport const drawPivot = (context, size=16, color=\"#FFF\")=> {\n    const halfSize = size / 2;\n\n    context.save();\n    context.strokeStyle = color;\n    context.lineWidth = 4;\n    context.globalAlpha = 0.4;\n    context.beginPath();\n    context.moveTo(-halfSize, 0);\n    context.lineTo(halfSize, 0);\n    context.moveTo(0, -halfSize);\n    context.lineTo(0, halfSize);\n    context.stroke();\n    context.restore();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/debug.js","class Sprite {\n    constructor (x=0, y=0) {\n        this.x = x;\n        this.y = y;\n        this.width = 64;\n        this.height = 64;\n        this.alpha = 1;\n        this.rotation = 0;\n        this.scaleX = 1;\n        this.scaleY = 1;\n        this.pivotX = 0;\n        this.pivotY = 0;\n        this.draggable = false;\n        this.visible = true;\n        this.composite = \"source-over\";\n        this.uid = Sprite.uid++;\n    }\n\n    render (context) {\n        if (!this.visible) {\n            return;\n        }\n\n        context.translate(this.x, this.y);\n        context.rotate(this.rotation * Math.PI / 180);\n        context.scale(this.scaleX, this.scaleY);\n        context.translate(-this.pivotX, -this.pivotY);\n\n        context.globalAlpha = this.alpha;\n        context.globalCompositeOperation = this.compositeOperation;\n\n        // TODO - R E M O V E ! ! !\n        context.fillStyle = \"#000\";\n        context.fillRect(0, 0, this.width, this.height);\n    }\n\n    get globalX () {\n        return this.x - this.pivotX * this.scaleX;\n    }\n\n    get globalY () {\n        return this.y - this.pivotY * this.scaleY;\n    }\n}\n\nSprite.uid = 0;\n\nexport default Sprite;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Sprite.js"],"sourceRoot":""}